---
import { languages } from "../i18n/ui";
import { getLangFromUrl } from "../i18n/utils";
import { Icon } from "astro-icon/components";

const lang = getLangFromUrl(Astro.url);
const langLabel = lang === "es" ? "ESP" : "EN";
---

<div class="relative group z-30 text-2xl cursor-pointer" id="languagePicker" tabindex="0">
  <ul
    class="absolute bg-sr-600 scale-y-0 group-focus:scale-100 -translate-y-full sm:translate-y-[60%] transition delay-75 -z-10"
    id="languageOptions"
  >
    {
      Object.entries(languages).map(([lang]) => {
        const languageLabel = lang === "es" ? "Espa√±ol" : "English";
        const path =lang === "es" ?  "/es" : "/"

        return (
          <li
            tabindex={0}
            class="first:border-b hover:bg-black/10 px-2 py-1 font-semibold"
          >
            <a href={path}>{languageLabel}</a>
          </li>
        );
      })
    }
  </ul>

  <div
    class="flex items-center gap-2 z-10 mx-auto group-focus:text-sr-300 text-xl sm:text-2xl"
  >
    <span>{langLabel}</span>
    <Icon name="row" class="rotate-90 group-focus:text-sr-500" />
    {lang == "es" ? <Icon name="flags/colombia" /> : <Icon name="flags/us" class="rounded-full"/>}
  </div>
</div>
